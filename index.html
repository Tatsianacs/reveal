<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Rolling Scopes Presentation</title>
  <link rel="stylesheet" href="css/reveal.css">
  <link rel="stylesheet" href="css/theme/league.css" id="theme">
  <link rel="stylesheet" href="lib/css/zenburn.css">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
<div class="reveal">
  <div class="slides">
    <section class="main-slide">
      <h1 class="main-slide">Event Loop. CSS Animation</h1>
      <span class=" author">by Tatsiana Masiukevich</span>
    </section>
    <section>
      <h2><span class="js">JS</span> is single-threaded</h2>
      <span class="fragment highlight-red" data-fragment-index="1">one thread = </span>
      <span class="fragment highlight-blue" data-fragment-index="2">one callstack = </span>
      <span class="fragment highlight-green" data-fragment-index="3">one thing at a time</span>
    </section>
    <section>
      <h3>The Runtime</h3>
      <img src="img/event_loop.png" class="runtime-example" alt="Runtime Overview">
    </section>
    <section>
      <section>
        <h3>Event Loop</h3>
        <pre><code class="test">
              console.log('Hi');
              setTimeout(function cb1() {
                  console.log('cb1');
              }, 5000);
              console.log('Bye');
          </code></pre>
      </section>
      <section>
        <img src="img/loop.gif" class="event-loop-example" alt="Event Loop example">
        <pre><code class="test">
              console.log('Hi');
              setTimeout(function cb1() {
                  console.log('cb1');
              }, 5000);
              console.log('Bye');
          </code></pre>
      </section>
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/1.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/2.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/3.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/4.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/5.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/6.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/7.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/8.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/9.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
           <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/10.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/11.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/12.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/13.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/14.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/15.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
      <!--<section>-->
          <!--<pre><code class="test">-->
              <!--console.log('Hi');-->
              <!--setTimeout(function cb1() {-->
                  <!--console.log('cb1');-->
              <!--}, 5000);-->
              <!--console.log('Bye');-->
          <!--</code></pre>-->
        <!--<img src="img/event_loop/16.png" class="event-loop-example" alt="Event Loop example">-->
      <!--</section>-->
    </section>

    <section>
      <section>
        <h3>Event Loop</h3>
        <p>It is infinitely looping and looking for new tasks to
          execute.</p>
        <p class="fragment highlight-blue" data-fragment-index="1">Generic task sources</p>
        <ul class="fragment" data-fragment-index="2">
          <li>The DOM manipulation</li>
          <li>The user interaction</li>
          <li>The networking</li>
          <li>The history traversal</li>
        </ul>
      </section>
      <section>
        <p><span class="highlighted">A task queue</span> is an ordered list of tasks</p>
        <p class="fragment" data-fragment-index="1">An event loop has <span
          class="highlighted">one or more macrotask</span> task queues.</p>
        <p class="fragment" data-fragment-index="2">An event loop <span
          class="highlighted">only one microtask queue.</span></p>
        <ul class="fragment" data-fragment-index="3">
          <li><span class="highlighted">macrotasks:</span> setTimeout, setInterval, setImmediate,
            requestAnimationFrame,
            I/O, UI rendering
          </li>
          <li><span class="highlighted">microtasks:</span> Promises, Object.observe, MutationObserver</li>
        </ul>
      </section>
      <section>
        <h3>Event Loop</h3>
        <ul class="fragment" data-fragment-index="1">
          <li>For each loop of the ‘event loop’ one macrotask is completed out of the macrotask queue</li>
          <li>After that macrotask is complete, the event loop visits the microtask queue.</li>
          <li>The entire microtask queue is completed before moving on.</li>
        </ul>
        <p class="fragment highlight-current-blue" data-fragment-index="2">This entire process of reading
          code,
          queueing up tasks, and executing tasks is the event loop.</p>
      </section>
      <section>
        <h3>Browser Specific</h3>
        <p>Handling and definition of macrotask vs microtask is up to the Browser</p>
      </section>
    </section>
    <section>
      <section>
        <h3>Event Loop. Practice</h3>
        <pre><code>
          console.log('script start');

          setTimeout(function() {
            console.log('setTimeout');
          }, 0);

          Promise.resolve().then(function() {
            console.log('promise1');
          }).then(function() {
          console.log('promise2');
          });

          console.log('script end');
        </code></pre>
        <p>What is expected in Browser console?</p>
      </section>
      <section>
        <h3>In console on 12.2018</h3>
        <img src="img/compare-browsers-now.png" alt="Compare browsers now">
      </section>
      <section>
        <h3>What if we check older version?</h3>
        <img src="img/ff-comparison.png" alt="Compare FF versions">
      </section>
      <section>
        <h3>More examples:</h3>
        <a class="link-to-source" href="https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/"
           target="_blank">Tasks,microtasks, queues and schedules</a>
        <img src="img/visit-link.gif" class="visit-link" alt="Visit the link above">
      </section>
    </section>
    <section>
      <section><a class="link-to-source" href="http://latentflip.com/loupe/" target="_blank">Loupe visualisation
        (how
        call stack/event
        loop/callback queue interact with each other)</a>
        <img src="img/loop-test.gif" class="loop-test-single" alt="Loupe visualisation">
      </section>
      <section><a href="http://latentflip.com/loupe/" target="_blank">What happens if the user clicks multiple
        times?</a>
        <img src="img/many_clicks.gif" class="loop-test" alt="Loupe visualisation">
      </section>
    </section>
    <section>
      <h3>Animation</h3>
      <p>The two primary ways to create web animations are by using JavaScript and CSS</p>
    </section>
    <section>
      <section>
        <h3>JS Animation</h3>
        <img src="img/set-inverval.png" alt="setInverval is bad">
        <img src="img/requestAnimationFrame.png" alt="requestAnimationFrame is good">
      </section>
      <section>
        <h3>JS Animation: Web Animations API</h3>
        <pre><code>
            var target = document.querySelector('.box');
            var player = target.animate([
              {transform: 'translate(0)'},
              {transform: 'translate(100px, 100px)'}
            ], 500);
            player.addEventListener('finish', function() {
              target.style.transform = 'translate(100px, 100px)';
            });
        </code></pre>
      </section>
      <section>
        <h3>JS Animation: Result</h3>
        <img src="img/js-animate.gif" alt="JS animate">
      </section>
    </section>
    <section>
      <section>
        <h3>CSS Transitions</h3>
        <pre><code>
            .box {
              -webkit-transform: translate(0, 0);
              -webkit-transition: -webkit-transform 500ms;

              transform: translate(0, 0);
              transition: transform 500ms;
            }

            .box.move {
              -webkit-transform: translate(100px, 100px);
              transform: translate(100px, 100px);
            }
        </code></pre>
        <a class="link-to-source" href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_animated_properties" target="_blank">Animatable properties</a>
      </section>
      <section>
        <h3>CSS Transitions: result</h3>
        <img src="img/css-transitions.gif" alt="Animated via CSS transiions box">
      </section>
      <section>
        <h3>Can I use CSS transition?</h3>
        <img src="img/can-i-use-transition.png" alt="Can I use transition?">
      </section>
    </section>
    <section>
      <section>
        <h3>CSS Animations</h3>
        <pre><code>
            .box {
              animation-name: movingBox;
              animation-duration: 2300ms;
              animation-iteration-count: infinite;
              animation-direction: alternate;
            }
            @keyframes movingBox {
              0% {
                transform: translate(0, 0);
                opacity: 0.4;
              }
              25% {
                opacity: 0.9;
              }
              50% {
                transform: translate(150px, 200px);
                opacity: 0.2;
              }
              100% {
                transform: translate(40px, 30px);
                opacity: 0.8;
              }
            }
        </code></pre>
      </section>
      <section>
        <h3>CSS Animation: result</h3>
        <img src="img/css-transitions.gif" alt="Animated via CSS transiions box">
      </section>
      <section>
        <section>
          <h3>Can I use CSS animation?</h3>
          <img src="img/can-i-use-animation.png" alt="Can I use animation?">
        </section>
      </section>
    </section>
    <section>
      <section>
        <h3>CSS Triggers</h3>
        <ul>
          <li>CSS properties that trigger the repainting of the page are the most costly to animation
            performance
          </li>
          <li>The more repainting, the poorer the performance</li>
          <li>The opacity and transform properties are best for animations</li>
        </ul>
      </section>
      <section>
        <img src="img/css-triggers.png" alt="CSS Triggers">
      </section>
      <section>
        <h3>More examples:</h3>
        <a class="link-to-source" href="https://csstriggers.com/" target="_blank">CSS Triggers</a>
        <img src="img/visit-link.gif" class="visit-link" alt="Visit the link above">
      </section>
    </section>
    <section>
      <section>
        <h3>Will-change</h3>
        <img src="img/will-change.png" alt="Can I use will change?">
      </section>
      <section>
        <h3>Will-change: example</h3>
        <pre><code>
          .el {
              will-change: transform;
          }

          .el:hover {
              transform: rotate()...;
          }
        </code></pre>
      </section>
    </section>
    <section>
      <section>
        <h3>Animation Performance in 'fast' mode</h3>
        <img src="img/animation-dev-tools-fast.png" class="performance-check" alt="Performance fast">
      </section>
      <section>
        <h3>Animation Performance in 'slow' mode</h3>
        <img src="img/animation-dev-tools-slow.png" class="performance-check" alt="Performance slow">
      </section>
    </section>
    <section>
      <section>
        <a class="link-to-source" href="http://cssdeck.com/labs/sunsetandmoon" target="_blank">Example: sunset
          and
          moon</a>
        <img src="img/sunset-moon.gif" alt="Animation example sunset and moon">
      </section>
      <section>
        <a class="link-to-source" href="https://codepen.io/Mark_Bowley/pen/mEtqj" target="_blank">Example:
          bubbles</a>
        <img src="img/bubbles.gif" alt="Animation example bubbles">
      </section>
      <section>
        <a class="link-to-source" href="http://cssdeck.com/labs/4gt1nsbb" target="_blank">Example: clock</a>
        <img src="img/clock.gif" alt="Animation example">
      </section>
    </section>
    <section>
      <h3>Useful links</h3>
      <ul>
        <li><a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/EventLoop" target="_blank">MDN,
          Concurrency
          model and Event Loop</a></li>
        <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" target="_blank">W3C
          HTML5 -
          Event loop</a></li>
        <li><a href="https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/" target="_blank">Tasks,
          microtasks, queues and schedules</a></li>
        <li><a href="http://latentflip.com/loupe/" target="_blank">Loupe visualisation (how call stack/event
          loop/callback queue interact with each other)</a></li>
        <li><a href="https://www.youtube.com/watch?v=8aGhZQkoFbQ" target="_blank">Philip Roberts: What the heck
          is the
          event loop anyway?</a></li>
        <li><a href="https://www.youtube.com/watch?v=cCOL7MC4Pl0" target="_blank">Jake Archibald: In The
          Loop</a></li>
        <li><a href="https://csstriggers.com/" target="_blank">CSS triggers (animation) </a></li>
        <li><a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/"
               target="_blank">Chrome
          Dev Tool: Analyzing Runtime Performance</a></li>
      </ul>
    </section>
    <section>
      <h3>Thank you!</h3>
      <img src="img/loop-cat.gif" alt="Cap spinning a pillow">
    </section>
  </div>
</div>
<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>
<script>
  Reveal.initialize({
    controls: true,
    progress: true,
    history: true,
    center: true,

    transition: 'slide',

    dependencies: [
      {
        src: 'lib/js/classList.js', condition: function () {
          return !document.body.classList;
        }
      },
      {
        src: 'plugin/markdown/marked.js', condition: function () {
          return !!document.querySelector('[data-markdown]');
        }
      },
      {
        src: 'plugin/markdown/markdown.js', condition: function () {
          return !!document.querySelector('[data-markdown]');
        }
      },
      {
        src: 'plugin/highlight/highlight.js', async: true, callback: function () {
          hljs.initHighlightingOnLoad();
        }
      },
      {src: 'plugin/search/search.js', async: true},
      {src: 'plugin/zoom-js/zoom.js', async: true},
      {src: 'plugin/notes/notes.js', async: true}
    ]
  });
</script>
</body>
</html>
